<!-- print the select currency and all its rates within a maximum 5 business days -->
{% load static %}
<html>
<head>
    <title>Exchange Rates</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/refresh.js' %}"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
</head>
<body>
    <h1>Exchange Rates</h1>
    <div class="border" id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
    {% for rate in rates %}
    
    <table>
        <tr>
            <th>Date</th>
            <th>Rate</th>
        </tr>
    <tr>
        <td>{{ rate.date }}</td>
        <td>{{ rate.value }}</td>
    </tr>
    {% endfor %}
    </table>
    <div class="d-flex justify-content-center">
        <form action="{% url 'currencies:index' %}" method="post">
            {% csrf_token %}
            {{ form.errors }}
            {{ form.as_table }}
            <input type="submit" value="Submit" style="visibility: hidden;" id="sub">
        </form>
    </div>


    <script>
        var _categories = [
            {% for rate in rates %}
                '{{ rate.date }}',
            {% endfor %}
        ];

        var _rates = [
            {% for rate in rates %}
                {{ rate.value }},
            {% endfor %}
        ];
        Highcharts.chart('container', {
        chart: {
                type: 'line'
        },
        title: {
                text: 'Rates'
        },
        xAxis: {
                categories: _categories,
                crosshair: true
        },
        yAxis: {
                min: Math.min(..._rates)*0.9,
                title: {
            text: 'Rate'
                }
        },
        tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:.2f} USD</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
        },
        plotOptions: {
                column: {
            pointPadding: 0.2,
            borderWidth: 0
          }
        },
        series: [{
                name: 'Price',
                data: _rates
        }]
        });
        </script>

</html>